<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Realistic Log Demo</title>
  <style>
    * {
      box-sizing: border-box; margin: 0; padding: 0;
    }
    body {
      font-family: Arial, sans-serif;
      background: #f0f2f5;
      color: #333;
    }
    .navbar {
      background: linear-gradient(45deg, #0069d9, #007bff);
      color: #fff; padding: 20px;
      text-align: center;
    }
    .navbar h1 {
      font-weight: 600; font-size: 1.8rem;
    }
    .ip-bar {
      background: #fff; padding: 15px 20px;
      display: flex; align-items: center; justify-content: center; gap: 10px;
      box-shadow: 0 0 8px rgba(0, 0, 0, 0.1);
    }
    .ip-bar img {
      width: 20px; height: 20px;
    }
    .container {
      max-width: 900px; margin: 30px auto; padding: 0 20px;
    }
    h2 {
      text-align: center; margin-bottom: 20px; font-weight: 600;
    }
    .log-list {
      display: flex; flex-direction: column; gap: 20px;
    }
    .log-item {
      background-color: #ffffff;
      border-radius: 8px; padding: 15px 20px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
      display: flex; flex-wrap: wrap; justify-content: space-between; gap: 10px;
      transition: box-shadow 0.3s ease;
    }
    .log-item:hover {
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
    }
    .log-event {
      display: flex; align-items: center; gap: 8px; min-width: 170px;
    }
    .log-event img {
      width: 20px; height: 20px;
    }
    .log-event .event-name {
      font-size: 1rem; font-weight: bold;
    }
    .log-info {
      display: flex; flex-direction: column; gap: 5px;
    }
    .log-info div {
      font-size: 0.95rem; color: #444;
    }
    .log-info div strong {
      font-weight: 600; color: #333;
    }
    @media (max-width: 600px) {
      .log-item {
        flex-direction: column; align-items: flex-start;
      }
    }
  </style>
</head>
<body>

  <!-- HEADER -->
  <div class="navbar">
    <h1>Realistic Log Demo</h1>
  </div>

  <!-- IP BAR -->
  <div class="ip-bar" id="ip-bar"></div>

  <div class="container">
    <h2>Activity Logs</h2>
    <div class="log-list" id="log-list"></div>
  </div>

  <script>
    /********************************************
     * CONFIG
     ********************************************/
    const IP_ADDRESS = "99.246.233.89"; // Change any time

    // The event entries we want, each with a subject & recipient if needed:
    const EVENT_ENTRIES = [
      {
        event: "Project Deleted",
        subject: "Project #{{proj}}",  // We'll randomize the project ID
        recipient: "bobjoebilly991@gmail.com"
      },
      {
        event: "Transcript Generated from Project",
        subject: "Project #{{proj}}",
        recipient: "bobjoebilly991@gmail.com"
      },
      {
        event: "User Logged in Successfully",
        subject: null,
        recipient: null
      },
      {
        event: "User Logged in Successfully",
        subject: null,
        recipient: null
      },
      {
        // Subscription event => always #QB49, same email
        event: "Subscription Update",
        subject: "Subscription #QB49",
        recipient: "bobjoebilly991@gmail.com"
      },
    ];

    // We'll pick times between these two dates, skipping overnight "midnight hours".
    // Example: Only random times on 2025-02-07 from 8:00 AM to 8:00 PM
    const START_DATE = new Date("2025-02-07T08:00:00");
    const END_DATE   = new Date("2025-02-07T20:00:00");

    // Icons
    const emailIcon    = "https://img.icons8.com/ios-filled/20/007bff/new-post.png"; 
    const passwordIcon = "https://img.icons8.com/ios-filled/20/007bff/password1.png";
    const ipIcon       = "https://img.icons8.com/ios-filled/20/007bff/network.png";

    /********************************************
     * HELPER FUNCTIONS
     ********************************************/
    function setIPBar(ip) {
      const ipBar = document.getElementById("ip-bar");
      ipBar.innerHTML = `
        <img src="${ipIcon}" alt="IP Icon" />
        <span>IP Address: ${ip}</span>
      `;
    }

    // Basic icon logic; for more advanced filtering, expand as needed
    function getIconForEvent(eventName) {
      if (!eventName) return emailIcon; // fallback
      if (eventName.toLowerCase().includes("password")) {
        return passwordIcon;
      }
      return emailIcon;
    }

    // Format date/time with 12-hour clock
    function formatDate(date) {
      return date.toLocaleString("en-US", { hour12: true });
    }

    // Return a random integer in [min, max]
    function randInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    // Replace placeholders like {{proj}} with random ID
    function fillSubject(subject) {
      if (!subject) return "N/A";
      let s = subject;
      // e.g. Project #{{proj}} => Project #123
      s = s.replace("{{proj}}", randInt(100, 999));
      return s;
    }

    // We want a random date/time between startDate & endDate BUT avoid midnight hours
    // (in this example, we skip any hour < 8 or >= 20 by simply bounding start/end).
    // If you had a multi-day range, you'd do a loop that re-picks if hour not in [8..20].
    function randomDateInRange(start, end) {
      const startMs = start.getTime();
      const endMs   = end.getTime();

      // Get a random ms from [startMs, endMs]
      const randomMs = randInt(startMs, endMs);
      return new Date(randomMs);
    }

    // Render logs from oldest at bottom to newest at top
    function renderLogs(logs) {
      const container = document.getElementById("log-list");
      container.innerHTML = ""; // clear old

      // Sort ascending by date
      logs.sort((a, b) => a.date - b.date);

      // Insert from newest to oldest
      for (let i = logs.length - 1; i >= 0; i--) {
        const log = logs[i];

        // Build DOM elements
        const item = document.createElement("div");
        item.classList.add("log-item");

        const eventBlock = document.createElement("div");
        eventBlock.classList.add("log-event");
        eventBlock.innerHTML = `
          <img src="${getIconForEvent(log.event)}" alt="icon" />
          <span class="event-name">${log.event}</span>
        `;

        const infoBlock = document.createElement("div");
        infoBlock.classList.add("log-info");
        infoBlock.innerHTML = `
          <div><strong>Recipient:</strong> ${log.recipient ?? "N/A"}</div>
          <div><strong>Subject:</strong> ${log.subject ?? "N/A"}</div>
          <div><strong>Date & Time:</strong> ${formatDate(log.date)}</div>
          <div><strong>Tag:</strong> #EmailLog</div>
        `;

        item.appendChild(eventBlock);
        item.appendChild(infoBlock);
        container.appendChild(item);
      }
    }

    /********************************************
     * MAIN
     ********************************************/
    window.addEventListener("DOMContentLoaded", () => {
      // 1) Show IP
      setIPBar(IP_ADDRESS);

      // 2) Build logs with random times
      const logs = EVENT_ENTRIES.map(evt => {
        return {
          event: evt.event,
          subject: fillSubject(evt.subject),
          recipient: evt.recipient ?? "N/A",
          date: randomDateInRange(START_DATE, END_DATE)
        };
      });

      // 3) Render
      renderLogs(logs);
    });
  </script>
</body>
</html>
